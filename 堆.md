# 堆

### 定义

1. 堆是一个完全二叉树
2. 堆中的每一个节点的值都必须大于等于（小于等于）其子树中每个节点的值；或者说：堆中的每个节点的值都必须大于等于（小于等于）其左右子节点的值
3. 对于每个节点的值都大于等于子树中每个节点值的堆，我们叫作“大顶堆”；对于每个节点的值都小于等于子树中每个节点值的堆，我们叫作“小顶堆”

### 实现

```java
public class Heap<T extends Comparable<T>> {
    private T[] data;
    private int capacity;
    private int size;

    public Heap(int capacity) {
        this.capacity = capacity;
        data = (T[]) new Comparable[capacity + 1];
    }

    public T remove() {
        if (size == 0) {
            return null;
        }
        T result = data[1];
        data[1] = data[size];
        size--;
        int i = 1;
        while (true) {
            if (i * 2 <= size && data[i].compareTo(data[i * 2]) < 0) {
                swap(i, i * 2);
                i = i * 2;
            } else if (i * 2 + 1 <= size && data[i].compareTo(data[i * 2 + 1]) < 0) {
                swap(i, i * 2 + 1);
                i = i * 2 + 1;
            } else {
                break;
            }
        }
        return result;
    }

    public boolean add(T in) {
        if (size + 1 > capacity) {
            return false;
        }
        size++;
        data[size] = in;
        int i = size;
        while (i / 2 > 0 && data[i / 2].compareTo(data[i]) < 0) {
            swap(i, i / 2);
            i /= 2;
        }
        return true;
    }

    public T top() {
        return data[1];
    }

    @Override
    public String toString() {
        StringBuilder sb = new StringBuilder();
        for (int i = 1, line = 1; i <= size;) {
            for (int j = 0; j < line && i <= size; j++, i++) {
                sb.append(data[i]);
                sb.append(" ");
            }
            sb.append(System.lineSeparator());
            line *= 2;
        }
        return sb.toString();
    }

    private void swap(int i, int j) {
        T tmp = data[i];
        data[i] = data[j];
        data[j] = tmp;
    }

    public static void main(String[] args) {
        Heap<Integer> heap = new Heap<>(10);
        for (int i = 0; i < 10; i++) {
            heap.add(RandomUtil.randInt(1, 5));
        }
        System.out.println(heap);
    }
}
```

