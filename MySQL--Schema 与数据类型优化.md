# MySQL--Schema 与数据类型优化

### 数据类型

选择优化的数据类型有3个原则：

1. 在满足范围需求的情况下使用最小的数据类型
2. 尽量使用简单的数据类型
3. 列约束最好不能为`NULL`

### 整数类型

可选`UNSIGNED`属性，表示不允许负值，可以使正数上限提高一倍。

选择不同的数据类型决定MySQL怎么在内存和磁盘中保存数据，计算时都转换成64位`BIGINT`整数。

MySQL可以为整数类型指定宽度，例如`INT(11)`，对大多数应用没有意义：不限制值的合法范围，只是规定了MySQL的一些交互工具(例如MySQL命令行客户端)用来显示字符的个数。对于存储和计算来说，`INT(1)`和`INT(20)`是相同的。

### 实数类型

DECIMAL(N, M) 用于存储精确小数，存储N个数字，小数点后存储M个精确，MySQL5.0及更高版本最多存储65个数字，使用二进制字符串进行保存(每4个字节存9个数字)。

FLOAT和DOUBLE存储非精确浮点数，使用时建议不要指定精度。

DECIMAL需要额外的空间和计算开销，应该只在对小数进行精确计算时使用——例如存储财务数据。也可以使用BIGINT代替，根据小数的位数乘以相应的倍数把小数转换成整数，这样就能避免浮点存储计算不精确和DECIMAL精确计算代价高的问题。

### 字符串类型

- VARCHAR：可变长字符串，使用1或2个额外字节记录字符串长度。`UPDATE`可能会使行更长造成页分裂。适用场景：字符串列的最大长度比平均长度大很多；列的更新很少，所以碎片不是问题；使用UTF-8(不同字符占用不同字节数)
- CHAR：定长字符串，存储时MySQL会删除所有末尾空格，适合存储很短的字符串，或者所有值都接近同一个长度
- BLOB和TEXT：都是为了存储很大的数据设计的字符串，分别采用二进制和字符方式存储，不建议使用。
- ENUM：枚举把列表值存储为数字，占用1或2个字节，按定义时的列表顺序进行排序，从1开始，在表的.frm文件中保存"数字-字符串"映射关系的"查找表"。

### 日期和时间类型

- DATETIME：占用8字节，存储时间从1001年到9999年，精度是秒。它把日期和时间封装到格式为yyyyMMddHHmmss的整数，与时区无关
- TIMESTAMP：占用4字节，从1970年到2038年，存储UNIX时间戳，与时区相关，默认`NOT NULL`。`FROM_UNIXTIME()`函数把Unix时间戳转换为日期，`UNIX_TIMESTAMP()`函数把日期转换为Unix时间戳





